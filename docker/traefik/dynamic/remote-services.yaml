# =============================================================================
# Traefik Dynamic Configuration - Remote Services (Gatus Routers)
# =============================================================================
# This file defines routers for services hosted on remote nodes (e.g., Nexus)
# that require specialized authentication for Gatus health checks.
# =============================================================================

http:
  routers:
    # -------------------------------------------------------------------------
    # Bazarr
    # -------------------------------------------------------------------------
    bazarr-gatus:
      entryPoints:
        - websecure
      middlewares:
        - monitoring@file
      rule: 'Host(`bazarr.{{ env "DOMAIN" }}`) && PathPrefix(`/api`)'
      service: nexus
      tls:
        certResolver: letsencrypt
      priority: 100

    # -------------------------------------------------------------------------
    # Lidarr
    # -------------------------------------------------------------------------
    lidarr-gatus:
      entryPoints:
        - websecure
      middlewares:
        - monitoring@file
      rule: 'Host(`lidarr.{{ env "DOMAIN" }}`) && PathPrefix(`/api`)'
      service: nexus
      tls:
        certResolver: letsencrypt
      priority: 100

    # -------------------------------------------------------------------------
    # Profilarr
    # -------------------------------------------------------------------------
    profilarr-gatus:
      entryPoints:
        - websecure
      middlewares:
        - monitoring@file
      rule: 'Host(`profilarr.{{ env "DOMAIN" }}`) && PathPrefix(`/api`)'
      service: nexus
      tls:
        certResolver: letsencrypt
      priority: 100

    # -------------------------------------------------------------------------
    # Prowlarr
    # -------------------------------------------------------------------------
    prowlarr-gatus:
      entryPoints:
        - websecure
      middlewares:
        - monitoring@file
      rule: 'Host(`prowlarr.{{ env "DOMAIN" }}`) && PathPrefix(`/api`)'
      service: nexus
      tls:
        certResolver: letsencrypt
      priority: 100

    # -------------------------------------------------------------------------
    # Radarr
    # -------------------------------------------------------------------------
    radarr-gatus:
      entryPoints:
        - websecure
      middlewares:
        - monitoring@file
      rule: 'Host(`radarr.{{ env "DOMAIN" }}`) && PathPrefix(`/api`)'
      service: nexus
      tls:
        certResolver: letsencrypt
      priority: 100

    # -------------------------------------------------------------------------
    # Sabnzbd
    # -------------------------------------------------------------------------
    sabnzbd-gatus:
      entryPoints:
        - websecure
      middlewares:
        - monitoring@file
      rule: 'Host(`sabnzbd.{{ env "DOMAIN" }}`) && PathPrefix(`/api`)'
      service: nexus
      tls:
        certResolver: letsencrypt
      priority: 100

    # -------------------------------------------------------------------------
    # Sonarr
    # -------------------------------------------------------------------------
    sonarr-gatus:
      entryPoints:
        - websecure
      middlewares:
        - monitoring@file
      rule: 'Host(`sonarr.{{ env "DOMAIN" }}`) && PathPrefix(`/api`)'
      service: nexus
      tls:
        certResolver: letsencrypt
      priority: 100

  services:
    nexus:
      loadBalancer:
        servers:
          - url: "https://192.168.1.3"
        serversTransport: insecure

  serversTransports:
    insecure:
      insecureSkipVerify: true
